<script>
    // -- IMPORTS

    import AdminPage from '$component/element/AdminPage.svelte';
    import
    {
        handleCreateUserReview,
        handleDeleteUserReview,
        handleEditUserReview,
        isUserReviewModalOpen,
        loadUserReviewArray,
        profileArrayStore,
        userReviewArrayStore,
        selectedUserReviewStore,
        toggleUserReviewModal,
        hasMorePage,
        isUserReviewLoading
    }
    from '$store/userReviewStore';

    // -- CONSTANTS

    const filterParameterByKeyMap =
    {
        userName:
        {
            type: 'text',
            name: 'User',
            value: ''
        },
        ratedUserName:
        {
            type: 'text',
            name: 'Rated user',
            value: ''
        },
        rating:
        {
            type : 'number',
            name : 'Rating',
            value : 0
        },
        text:
        {
            type: 'text',
            name: 'Text',
            value: ''
        },
        creationTimestamp:
        {
            type: 'date',
            name: 'Created at',
            value: new Date().toISOString()
        },
        updateTimestamp:
        {
            type: 'date',
            name: 'Updated at',
            value: new Date().toISOString()
        }
    };

    const titleSlugMap =
    {
        editTitle: 'edit-user-review-label',
        addTitle: 'add-user-review-label'
    };

    // -- VARIABLES

    let filterableColumnByColumnNameMap =
        {
            id: { columnLabel: 'Rating ID', type: 'text' },
            ratedUserProfileId: { columnLabel: 'Rated User Profile ID', type: 'text' },
            rating: { columnLabel: 'Rating Score', type: 'text' },
            text: { columnLabel: 'Review Text', type: 'text' },
            userId: { columnLabel: 'User ID', type: 'text' },
            creationTimestamp: { columnLabel: 'Creation Date', type: 'timestamp' },
            updateTimestamp: { columnLabel: 'Update Date', type: 'timestamp' }
        };

    // -- FUNCTIONS

    function arrayProcessing(
        )
    {
    }

    // ~~

    async function handleNearBottom(
        event
        )
    {
        let { page } = event.detail;

        if ( $hasMorePage && !$isUserReviewLoading )
        {
            await loadUserReviewArray( page );
        }
    }
</script>

<style lang="stylus">
</style>

<AdminPage
    pageTitle="admin-menu-user-review-manager-label"
    selectedObject={ selectedUserReviewStore }
    objectArrayStore={ userReviewArrayStore }
    isObjectModalOpen={ isUserReviewModalOpen }
    filterParameterByKeyMap={ filterParameterByKeyMap }
    filterableColumnByColumnNameMap={ filterableColumnByColumnNameMap }
    titleSlugMap={ titleSlugMap }
    loadObjectArray={ loadUserReviewArray }
    arrayProcessing={ arrayProcessing }
    handleCreateObject={ handleCreateUserReview }
    handleEditObject={ handleEditUserReview }
    handleDeleteObject={ handleDeleteUserReview }
    toggleObjectModal={ toggleUserReviewModal }
    handleNearBottom={ handleNearBottom }
/>
