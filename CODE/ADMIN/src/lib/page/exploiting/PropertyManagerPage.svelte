<script>
    // -- IMPORTS

    import { getFilteredArray, getOptionArray, isDefinedAndNotNull } from '$lib/base';
    import {
        propertyArrayStore,
        propertyTypeArrayStore,
        propertyStatusArrayStore,
        rentalTypeArrayStore,
        heatingTypeArrayStore,
        diagnosisArrayStore,
        profileArrayStore,
        selectedPropertyStore,
        isPropertyModalOpen,
        loadPropertyArray,
        handleCreateProperty,
        handleEditProperty,
        handleDeleteProperty,
        togglePropertyModal,
        hasMorePropertyPagesStore,
        isPropertyLoading,
        isFormModified as isPropertyFormModified,
        addNavigationEventListener,
        finalizeNavigation,
        handleChange,
        isConfirmationModalOpen,
        removeNavigationEventListener,
        toggleConfirmModal,
        managerProfileArrayStore,
        isSubmitting
    }
    from '$store/propertyStore';
    import AdminPage from '$component/element/AdminPage.svelte';
    import { urlParamsStore } from '$store/urlParamsStore';
    import { languageTagStore } from '$store/languageTagStore';
    import { hasUserPermission } from '$store/profileStore';
    import ConfirmModal from '$component/element/ConfirmModal.svelte';
    import InputLocalizedForm from '$component/element/InputLocalizedForm.svelte';
    import { languageArrayStore } from '$store/languageArrayStore';
    import Input from '$component/element/Input.svelte';
    import Switch from '$component/element/Switch.svelte';
    import Select from '$component/element/Select.svelte';
    import { getLocalizedText, isArray } from 'senselogic-gist';
    import { generateFilePath } from '$lib/filePath';
    import Carousel from '$component/element/Carousel.svelte';
    import { cityArrayStore } from '$lib/store/cityArrayStore';
    import { countryArrayStore } from '$lib/store/countryArrayStore';
    import UserSelect from '$component/element/UserSelect.svelte';

    // -- CONSTANTS

    const titleSlugMap =
    {
        editTitle: 'edit-property-label',
        addTitle: 'add-property-label'
    };

    // -- VARIABLES

    let filterParameterByKeyMap =
    {
        id:
        {
            type: 'text',
            name: 'ID',
            value: ''
        },
        userName:
        {
            type: 'text',
            name: 'User',
            value: ''
        },
        managerName:
        {
            type: 'text',
            name: 'Manager User',
            value: ''
        },
        hasShortTermExtendedStayDiscount:
        {
            type: 'boolean',
            name: 'Extended Stay Discount',
            value: ''
        },
        hasShortTermProlongedStayDiscount:
        {
            type: 'boolean',
            name: 'Prolonged Stay Discount',
            value: ''
        },
        isAvailableForLongTerm:
        {
            type: 'boolean',
            name: 'Available For Long Term',
            value: ''
        },
        isAvailableForShortTerm:
        {
            type: 'boolean',
            name: 'Available For Short Term',
            value: ''
        },
        isAvailableForSublet:
        {
            type: 'boolean',
            name: 'Available For Sublet',
            value: ''
        },
        managesLongTermDocuments:
        {
            type: 'boolean',
            name: 'Manages Long Term Documents',
            value: ''
        },
        requiresCompleteRequestForVisits:
        {
            type: 'boolean',
            name: 'Requires Complete Request For Visits',
            value: ''
        },
        showsPreciseLocation:
        {
            type: 'boolean',
            name: 'Shows Precise Location',
            value: ''
        },
        averageAccuracyRating:
        {
            type: 'number',
            name: 'Average Accuracy Rating',
            value: ''
        },
        averageCheckInRating:
        {
            type: 'number',
            name: 'Average Check In Rating',
            value: ''
        },
        averageCleanlinessRating:
        {
            type: 'number',
            name: 'Average Cleanliness Rating',
            value: ''
        },
        averageCommunicationRating:
        {
            type: 'number',
            name: 'Average Communication Rating',
            value: ''
        },
        averageLocationRating:
        {
            type: 'number',
            name: 'Average Location Rating',
            value: ''
        },
        averageRating:
        {
            type: 'number',
            name: 'Average Rating',
            value: ''
        },
        averageValueRating:
        {
            type: 'number',
            name: 'Average Value Rating',
            value: ''
        },
        requiredLongTermMonthlyIncome:
        {
            type: 'number',
            name: 'Required Long Term Monthly Income',
            value: ''
        },
        longTermMonthlyPrice:
        {
            type: 'number',
            name: 'Long Term Monthly Price',
            value: ''
        },
        shortTermDailyPrice:
        {
            type: 'number',
            name: 'Short Term Daily Price',
            value: ''
        },
        shortTermExtendedStayDailyPrice:
        {
            type: 'number',
            name: 'Short Term Extended Stay Daily Price',
            value: ''
        },
        shortTermExtendedStayDayCount:
        {
            type: 'number',
            name: 'Short Term Extended Stay Day Count',
            value: ''
        },
        shortTermProlongedStayDailyPrice:
        {
            type: 'number',
            name: 'Short Term Prolonged Stay Daily Price',
            value: ''
        },
        shortTermProlongedStayDayCount:
        {
            type: 'number',
            name: 'Short Term Prolonged Stay Day Count',
            value: ''
        },
        longitude:
        {
            type: 'number',
            name: 'Longitude',
            value: ''
        },
        latitude:
        {
            type: 'number',
            name: 'Latitude',
            value: ''
        },
        apartmentNumber:
        {
            type: 'text',
            name: 'Apartment Number',
            value: ''
        },
        buildingNumber:
        {
            type: 'text',
            name: 'Building Number',
            value: ''
        },
        streetName:
        {
            type: 'text',
            name: 'Street Name',
            value: ''
        },
        cityName:
        {
            type: 'text',
            name: 'City Name',
            value: ''
        },
        countryName:
        {
            type: 'text',
            name: 'Country Name',
            value: ''
        },
        reference:
        {
            type: 'text',
            name: 'Reference',
            value: ''
        },
        rentalType:
        {
            type: 'select',
            name: 'Rental Type',
            optionArray: [],
            value: ''
        },
        heatingType:
        {
            type: 'select',
            name: 'Heating Type',
            optionArray: [],
            value: ''
        },
        countryCode:
        {
            type: 'select',
            name: 'Country Code',
            optionArray: [],
            value: ''
        },
        diagnosis:
        {
            type: 'select',
            name: 'Energy Diagnosis',
            optionArray: [],
            value: ''
        },
        propertyStatus:
        {
            type: 'select',
            name: 'Status',
            optionArray: [],
            value: ''
        },
        propertyType:
        {
            type: 'select',
            name: 'Type',
            optionArray: [],
            value: ''
        },
        title:
        {
            type: 'text',
            name: 'Title',
            value: ''
        },
        description:
        {
            type: 'text',
            name: 'Description',
            value: ''
        },
        date:
        {
            type: 'date',
            name: 'Date',
            value: ''
        },
        managerProfile:
        {
            type: 'object',
            name: '',
            value: ''
        },
        userProfile:
        {
            type: 'object',
            name: '',
            value: ''
        }
    };
    let filterableColumnByColumnNameMap =
        $state({
            id: { columnLabel: 'ID', type: 'text' },
            date: { columnLabel: 'Date', type: 'date' },
            reference: { columnLabel: 'Reference', type: 'text' },
            typeId: { columnLabel: 'Space Type', type: 'select', optionArray: [] },
            rentalTypeId: { columnLabel: 'Rental Type', type: 'select', optionArray: [] },
            statusId: { columnLabel: 'Status', type: 'select', optionArray: [] },
            heatingTypeId: { columnLabel: 'Heating Type', type: 'select', optionArray: [] },
            energyDiagnosisId: { columnLabel: 'Energy Diagnosis', type: 'select', optionArray: [] },
            title: { columnLabel: 'Title', type: 'text' },
            description: { columnLabel: 'Description', type: 'text' },
            streetName: { columnLabel: 'Street Name', type: 'text' },
            buildingNumber: { columnLabel: 'Building Number', type: 'text' },
            apartmentNumber: { columnLabel: 'Apartment Number', type: 'text' },
            cityName: { columnLabel: 'City Name', type: 'text' },
            cityId: { columnLabel: 'City ID', type: 'select', optionArray: [] },
            countryCode: { columnLabel: 'Country Code', type: 'select', optionArray: [] },
            countryName: { columnLabel: 'Country Name', type: 'text' },
            latitude: { columnLabel: 'Latitude', type: 'text' },
            longitude: { columnLabel: 'Longitude', type: 'text' },
            isAvailableForShortTerm: { columnLabel: 'Available for Short Term', type: 'boolean' },
            isAvailableForLongTerm: { columnLabel: 'Available for Long Term', type: 'boolean' },
            isAvailableForSublet: { columnLabel: 'Available for Sublet', type: 'boolean' },
            shortTermForSublet: { columnLabel: 'Short Term Sublet', type: 'boolean' },
            shortTermDailyPrice: { columnLabel: 'Short Term Daily Price', type: 'text' },
            hasShortTermExtendedStayDiscount: { columnLabel: 'Extended Stay Discount', type: 'boolean' },
            shortTermExtendedStayDayCount: { columnLabel: 'Extended Stay Day Count', type: 'text' },
            shortTermExtendedStayDailyPrice: { columnLabel: 'Extended Stay Daily Price', type: 'text' },
            hasShortTermProlongedStayDiscount: { columnLabel: 'Prolonged Stay Discount', type: 'boolean' },
            shortTermProlongedStayDayCount: { columnLabel: 'Prolonged Stay Day Count', type: 'text' },
            shortTermProlongedStayDailyPrice: { columnLabel: 'Prolonged Stay Daily Price', type: 'text' },
            longTermMonthlyPrice: { columnLabel: 'Long Term Monthly Price', type: 'text' },
            requiredLongTermMonthlyIncome: { columnLabel: 'Required Long Term Monthly Income', type: 'text' },
            requiredLongTermDocumentTypeIdList: { columnLabel: 'Required Long Term Documents', type: 'text' },
            requiresCompleteRequestForVisits: { columnLabel: 'Requires Complete Request for Visits', type: 'boolean' },
            managesLongTermDocuments: { columnLabel: 'Manages Long Term Documents', type: 'text' },
            averageRating: { columnLabel: 'Average Rating', type: 'text' },
            averageCleanlinessRating: { columnLabel: 'Average Cleanliness Rating', type: 'text' },
            averageCommunnicationRating: { columnLabel: 'Average Communication Rating', type: 'text' },
            averageCheckInRating: { columnLabel: 'Average Check-in Rating', type: 'text' },
            averageAccuracyRating: { columnLabel: 'Average Accuracy Rating', type: 'text' },
            averageLocationRating: { columnLabel: 'Average Location Rating', type: 'text' },
            averageValueRating: { columnLabel: 'Average Value Rating', type: 'text' },
            managerUserId: { columnLabel: 'Manager User ID', type: 'text' },
            userId: { columnLabel: 'Owner', type: 'text' },
            showsPreciseLocation: { columnLabel: 'Show precise location', type: 'boolean' },
            creationTimestamp: { columnLabel: 'Creation Date', type: 'timestamp' },
            updateTimestamp: { columnLabel: 'Update Date', type: 'timestamp' }
        });
    let tableConfig =
        $derived({
            headerArray :
                [
                    { type: 'profile', label: 'User', key: 'userProfile' },
                    { type: 'profile', label: 'Manager User', key: 'managerProfile' },
                    { type: 'boolean', label: 'Extended Stay Discount', key: 'hasShortTermExtendedStayDiscount' },
                    { type: 'boolean', label: 'Prolonged Stay Discount', key: 'hasShortTermProlongedStayDiscount' },
                    { type: 'boolean', label: 'Available For Long Term', key: 'isAvailableForLongTerm' },
                    { type: 'boolean', label: 'Available For Short Term', key: 'isAvailableForShortTerm' },
                    { type: 'boolean', label: 'Available For Sublet', key: 'isAvailableForSublet' },
                    { type: 'boolean', label: 'Manages Long Term Documents', key: 'managesLongTermDocuments' },
                    { type: 'boolean', label: 'Requires Complete Request For Visits', key: 'requiresCompleteRequestForVisits' },
                    { type: 'boolean', label: 'Shows Precise Location', key: 'showsPreciseLocation' },
                    { type: 'rating', label: 'Average Accuracy Rating', key: 'averageAccuracyRating' },
                    { type: 'rating', label: 'Average Check In Rating', key: 'averageCheckInRating' },
                    { type: 'rating', label: 'Average Cleanliness Rating', key: 'averageCleanlinessRating' },
                    { type: 'rating', label: 'Average Communication Rating', key: 'averageCommunicationRating' },
                    { type: 'rating', label: 'Average Location Rating', key: 'averageLocationRating' },
                    { type: 'rating', label: 'Average Rating', key: 'averageRating' },
                    { type: 'rating', label: 'Average Value Rating', key: 'averageValueRating' },
                    { type: 'amount', label: 'Required Long Term Monthly Income', key: 'requiredLongTermMonthlyIncome' },
                    { type: 'amount', label: 'Long Term Monthly Price', key: 'longTermMonthlyPrice' },
                    { type: 'amount', label: 'Short Term Daily Price', key: 'shortTermDailyPrice' },
                    { type: 'amount', label: 'Short Term Extended Stay Daily Price', key: 'shortTermExtendedStayDailyPrice' },
                    { type: 'number', label: 'Short Term Extended Stay Day Count', key: 'shortTermExtendedStayDayCount' },
                    { type: 'amount', label: 'Short Term Prolonged Stay Daily Price', key: 'shortTermProlongedStayDailyPrice' },
                    { type: 'number', label: 'Short Term Prolonged Stay Day Count', key: 'shortTermProlongedStayDayCount' },
                    { type: 'number', label: 'Longitude', key: 'longitude' },
                    { type: 'number', label: 'Latitude', key: 'latitude' },
                    { type: 'text', label: 'Apartment Number', key: 'apartmentNumber' },
                    { type: 'text', label: 'Building Number', key: 'buildingNumber' },
                    { type: 'text', label: 'Street label', key: 'streetlabel' },
                    { type: 'text', label: 'City label', key: 'citylabel' },
                    { type: 'text', label: 'Country label', key: 'countrylabel' },
                    { type: 'text', label: 'Reference', key: 'reference' },
                    { type: 'select', label: 'Rental Type', optionArray: [], key: 'rentalType' },
                    { type: 'select', label: 'Heating Type', optionArray: [], key: 'heatingType' },
                    { type: 'select', label: 'Country Code', optionArray: [], key: 'countryCode' },
                    { type: 'select', label: 'Energy Diagnosis', optionArray: [], key: 'diagnosis' },
                    { type: 'select', label: 'Status', optionArray: [], key: 'propertyStatus' },
                    { type: 'select', label: 'Type', optionArray: [], key: 'propertyType' },
                    { type: 'text', label: 'Title', key: 'title' },
                    { type: 'text', label: 'Description', key: 'description' },
                    { type: 'date', label: 'Date', key: 'date' }
                ],
            dataArray : $propertyArrayStore
        });

    // -- FUNCTIONS

    function arrayProcessing(
        )
    {
        filterableColumnByColumnNameMap.typeId.optionArray = getOptionArray( $propertyTypeArrayStore );
        filterableColumnByColumnNameMap.statusId.optionArray = getOptionArray( $propertyStatusArrayStore );
        filterableColumnByColumnNameMap.rentalTypeId.optionArray = getOptionArray( $rentalTypeArrayStore );
        filterableColumnByColumnNameMap.heatingTypeId.optionArray = getOptionArray( $heatingTypeArrayStore );
        filterableColumnByColumnNameMap.energyDiagnosisId.optionArray = getOptionArray( $diagnosisArrayStore );
    }

    // ~~

    async function handleNearBottom(
        event
        )
    {
        let { page } = event.detail;

        if ( !$isPropertyLoading && $hasMorePropertyPagesStore )
        {
            await loadPropertyArray( page );
            arrayProcessing();
            $propertyArrayStore = getFilteredArray( $propertyArrayStore, $urlParamsStore, filterParameterByKeyMap, $languageTagStore );
        }
    }

    // ~~

    function handleUpdatePropertyLocalizedInput(
        event
        )
    {
        handleChange();
        selectedPropertyStore.update( ( property ) => ( { ...property, [ event.detail.name ]: event.detail.text } ) );
    }
</script>

<style lang="stylus">
    // -- CLASSES

    .property-image
    {
        height: 18.75em;

        object-fit: cover;
        object-position center;
        width: 100%;
        aspect-ratio: 3 / 4;
    }
</style>

<AdminPage
    pageTitle="property-label"
    selectedObject={ selectedPropertyStore }
    objectArrayStore={ propertyArrayStore }
    isObjectModalOpen={ isPropertyModalOpen }
    filterParameterByKeyMap={ filterParameterByKeyMap }
    filterableColumnByColumnNameMap={ filterableColumnByColumnNameMap }
    titleSlugMap={ titleSlugMap }
    loadObjectArray={ loadPropertyArray }
    arrayProcessing={ arrayProcessing }
    handleCreateObject={ () => handleCreateProperty( arrayProcessing ) }
    handleEditObject={ () => handleEditProperty( arrayProcessing ) }
    handleDeleteObject={ () => handleDeleteProperty( arrayProcessing ) }
    toggleObjectModal={ togglePropertyModal }
    handleNearBottom={ handleNearBottom }
    tablePage={ true }
    showButton={ hasUserPermission( 'add-property' ) }
    isFormModified={ $isPropertyFormModified }
    isCustomTable={ true }
    objectConfigMap={ tableConfig }
    isSubmitting={ $isSubmitting }
>
    <form onchange={handleChange} class="edit-modal-form">
        {#if isArray( $selectedPropertyStore.imagePathArray ) }
            <div class="input-row">
                <!-- <Carousel
                    resumeDuration={ 5000 }
                >
                    {#each $selectedPropertyStore.imagePathArray as imagePath }
                        {#if isDefinedAndNotNull( imagePath ) }
                            <img class="property-image" src={ generateFilePath( imagePath ) } alt="">
                        {/if}
                    {/each}
                </Carousel> -->
            </div>
        {/if}

        <div class="input-row">
            <span class="font-weight-700 line-height-150 color-gray-100">Property title</span>
            <InputLocalizedForm
                name="title"
                itemsString={ $selectedPropertyStore.title }
                languageArray={ $languageArrayStore }
                on:update={ handleUpdatePropertyLocalizedInput }
            />
        </div>

        <div class="input-row">
            <span class="font-weight-700 line-height-150 color-gray-100">Property description</span>
            <InputLocalizedForm
                name="description"
                itemsString={ $selectedPropertyStore.description }
                languageArray={ $languageArrayStore }
                on:update={ handleUpdatePropertyLocalizedInput }
            />
        </div>

        <div class="input-row inline">
            <div class="input-row flex-grow">
                <span class="font-weight-700 line-height-150 color-gray-100">User name</span>
                <div style="width:100%;">
                    <UserSelect
                        bind:profile={ $selectedPropertyStore.userProfile }
                        bind:userId={ $selectedPropertyStore.userId }
                        on:change={ handleChange }
                        profileArray={ $profileArrayStore }
                    />
                </div>
            </div>

            <div class="input-row flex-grow">
                <span class="font-weight-700 line-height-150 color-gray-100">Manager name</span>
                <div style="width:100%;">
                    <UserSelect
                        bind:profile={ $selectedPropertyStore.managerProfile }
                        bind:userId={ $selectedPropertyStore.managerUserId }
                        on:change={ handleChange }
                        profileArray={ $profileArrayStore }
                    />
                </div>
            </div>
        </div>

        <div class="input-row inline">
            <div class="input-row flex-grow">
                <span class="font-weight-700 line-height-150 color-gray-100">Average Accuracy Rating</span>
                <Input
                    type="number"
                    bind:value={ $selectedPropertyStore.averageAccuracyRating }
                    fullWidth
                    name="averageAccuracyRating"
                    step="0.5"
                    min="0"
                    max="5"
                >
                    <!-- @migration-task: migrate this slot by hand, `start-adornment` is an invalid identifier -->
    <span slot="start-adornment">⭐</span>
                </Input>
            </div>

            <div class="input-row flex-grow">
                <span class="font-weight-700 line-height-150 color-gray-100">Average Check-In Rating</span>
                <Input
                    type="number"
                    bind:value={ $selectedPropertyStore.averageCheckInRating }
                    fullWidth
                    name="averageCheckInRating"
                    step="0.5"
                    min="0"
                    max="5"
                >
                    <!-- @migration-task: migrate this slot by hand, `start-adornment` is an invalid identifier -->
    <span slot="start-adornment">⭐</span>
                </Input>
            </div>
        </div>

        <div class="input-row inline">
            <div class="input-row flex-grow">
                <span class="font-weight-700 line-height-150 color-gray-100">Average Cleanliness Rating</span>
                <Input
                    type="number"
                    bind:value={ $selectedPropertyStore.averageCleanlinessRating }
                    fullWidth
                    name="averageCleanlinessRating"
                    step="0.5"
                    min="0"
                    max="5"
                >
                    <!-- @migration-task: migrate this slot by hand, `start-adornment` is an invalid identifier -->
    <span slot="start-adornment">⭐</span>
                </Input>
            </div>

            <div class="input-row flex-grow">
                <span class="font-weight-700 line-height-150 color-gray-100">Average Communication Rating</span>
                <Input
                    type="number"
                    bind:value={ $selectedPropertyStore.averageCommunicationRating }
                    fullWidth
                    name="averageCommunicationRating"
                    step="0.5"
                    min="0"
                    max="5"
                >
                    <!-- @migration-task: migrate this slot by hand, `start-adornment` is an invalid identifier -->
    <span slot="start-adornment">⭐</span>
                </Input>
            </div>
        </div>

        <div class="input-row inline">
            <div class="input-row flex-grow">
                <span class="font-weight-700 line-height-150 color-gray-100">Average Location Rating</span>
                <Input
                    type="number"
                    bind:value={ $selectedPropertyStore.averageLocationRating }
                    fullWidth
                    name="averageLocationRating"
                    step="0.5"
                    min="0"
                    max="5"
                >
                    <!-- @migration-task: migrate this slot by hand, `start-adornment` is an invalid identifier -->
    <span slot="start-adornment">⭐</span>
                </Input>
            </div>

            <div class="input-row flex-grow">
                <span class="font-weight-700 line-height-150 color-gray-100">Average Rating</span>
                <Input
                    type="number"
                    bind:value={ $selectedPropertyStore.averageRating }
                    fullWidth
                    name="averageRating"
                    step="0.5"
                    min="0"
                    max="5"
                >
                    <!-- @migration-task: migrate this slot by hand, `start-adornment` is an invalid identifier -->
    <span slot="start-adornment">⭐</span>
                </Input>
            </div>
        </div>

        <div class="input-row">
            <span class="font-weight-700 line-height-150 color-gray-100">Average Value Rating</span>
            <Input
                type="number"
                bind:value={ $selectedPropertyStore.averageValueRating }
                fullWidth
                name="averageValueRating"
            >
                <!-- @migration-task: migrate this slot by hand, `start-adornment` is an invalid identifier -->
    <span slot="start-adornment">⭐</span>
            </Input>
        </div>

        <div class="input-row">
            <span class="font-weight-700 line-height-150 color-gray-100">Required Long-Term Monthly Income</span>
            <Input
                type="number"
                bind:value={ $selectedPropertyStore.requiredLongTermMonthlyIncome }
                fullWidth
                name="requiredLongTermMonthlyIncome"
            >
                <!-- @migration-task: migrate this slot by hand, `start-adornment` is an invalid identifier -->
    <span slot="start-adornment">💲</span>
            </Input>
        </div>

        <div class="input-row inline">
            <div class="input-row flex-grow">
                <span class="font-weight-700 line-height-150 color-gray-100">Long-Term Monthly Price</span>
                <Input
                    type="number"
                    bind:value={ $selectedPropertyStore.longTermMonthlyPrice }
                    fullWidth
                    name="longTermMonthlyPrice"
                >
                    <!-- @migration-task: migrate this slot by hand, `start-adornment` is an invalid identifier -->
    <span slot="start-adornment">💲</span>
                </Input>
            </div>

            <div class="input-row flex-grow">
                <span class="font-weight-700 line-height-150 color-gray-100">Short-Term Daily Price</span>
                <Input
                    type="number"
                    bind:value={ $selectedPropertyStore.shortTermDailyPrice }
                    fullWidth
                    name="shortTermDailyPrice"
                    >
                    <!-- @migration-task: migrate this slot by hand, `start-adornment` is an invalid identifier -->
    <span slot="start-adornment">💲</span>
                </Input>
            </div>
        </div>

        <div class="input-row inline">
            <div class="input-row flex-grow">
                <span class="font-weight-700 line-height-150 color-gray-100">Short-Term Extended Stay Daily Price</span>
                <Input
                    type="number"
                    bind:value={ $selectedPropertyStore.shortTermExtendedStayDailyPrice }
                    fullWidth
                    name="shortTermExtendedStayDailyPrice"
                >
                    <!-- @migration-task: migrate this slot by hand, `start-adornment` is an invalid identifier -->
    <span slot="start-adornment">💲</span>
                </Input>
            </div>

            <div class="input-row flex-grow">
                <span class="font-weight-700 line-height-150 color-gray-100">Short-Term Extended Stay Day Count</span>
                <Input
                    type="number"
                    bind:value={ $selectedPropertyStore.shortTermExtendedStayDayCount }
                    fullWidth
                    name="shortTermExtendedStayDayCount"
                />
            </div>
        </div>

        <div class="input-row inline">
            <div class="input-row flex-grow">
                <span class="font-weight-700 line-height-150 color-gray-100">Short-Term Prolonged Stay Daily Price</span>
                <Input
                    type="number"
                    bind:value={ $selectedPropertyStore.shortTermProlongedStayDailyPrice }
                    fullWidth
                    name="shortTermProlongedStayDailyPrice"
                >
                    <!-- @migration-task: migrate this slot by hand, `start-adornment` is an invalid identifier -->
    <span slot="start-adornment">💲</span>
                </Input>
            </div>

            <div class="input-row flex-grow">
                <span class="font-weight-700 line-height-150 color-gray-100">Short-Term Prolonged Stay Day Count</span>
                <Input
                    type="number"
                    bind:value={ $selectedPropertyStore.shortTermProlongedStayDayCount }
                    fullWidth
                    name="shortTermProlongedStayDayCount"
                />
            </div>
        </div>

        <div class="input-row inline">
            <div class="input-row flex-grow">
                <span class="font-weight-700 line-height-150 color-gray-100">Longitude</span>
                <Input
                    type="text"
                    bind:value={ $selectedPropertyStore.longitude }
                    fullWidth
                    name="longitude"
                >
                    <!-- @migration-task: migrate this slot by hand, `start-adornment` is an invalid identifier -->
    <span slot="start-adornment">📍</span>
                </Input>
            </div>

            <div class="input-row flex-grow">
                <span class="font-weight-700 line-height-150 color-gray-100">Latitude</span>
                <Input
                    type="text"
                    bind:value={ $selectedPropertyStore.latitude }
                    fullWidth
                    name="latitude"
                >
                    <!-- @migration-task: migrate this slot by hand, `start-adornment` is an invalid identifier -->
    <span slot="start-adornment">📍</span>
                </Input>
            </div>
        </div>

        <div class="input-row inline">
            <div class="input-row flex-grow">
                <span class="font-weight-700 line-height-150 color-gray-100">Apartment number</span>
                <Input
                    type="text"
                    bind:value={ $selectedPropertyStore.apartmentNumber }
                    fullWidth
                    name="apartmentNumber"
                />
            </div>

            <div class="input-row flex-grow">
                <span class="font-weight-700 line-height-150 color-gray-100">Building number</span>
                <Input
                    type="text"
                    bind:value={ $selectedPropertyStore.buildingNumber }
                    fullWidth
                    name="buildingNumber"
                />
            </div>
        </div>

        <div class="input-row">
            <span class="font-weight-700 line-height-150 color-gray-100">Street name</span>
            <Input
                type="text"
                bind:value={ $selectedPropertyStore.streetName }
                fullWidth
                name="streetName"
            />
        </div>

        <div class="input-row inline">
            <div class="input-row flex-grow">
                <span class="font-weight-700 line-height-150 color-gray-100">City</span>
                <Select fullWidth name="cityId" bind:value={ $selectedPropertyStore.cityId }>
                    {#each $cityArrayStore as city }
                        <option value={ city.id }>{ getLocalizedText( city.name, $languageTagStore ) }</option>
                    {/each}
                </Select>
            </div>

            <div class="input-row flex-grow">
                <span class="font-weight-700 line-height-150 color-gray-100">Country</span>
                <Select fullWidth name="countryCode" bind:value={ $selectedPropertyStore.countryCode }>
                    {#each $countryArrayStore as country }
                        <option value={ country.id }>{ getLocalizedText( country.name, $languageTagStore ) }</option>
                    {/each}
                </Select>
            </div>
        </div>

        <div class="input-row">
            <span class="font-weight-700 line-height-150 color-gray-100">Reference</span>
            <Input
                type="text"
                bind:value={ $selectedPropertyStore.reference }
                fullWidth
                name="reference"
            />
        </div>

        <div class="input-row">
            <span class="font-weight-700 line-height-150 color-gray-100">Rental type</span>
            <Select fullWidth name="rentalType" bind:value={ $selectedPropertyStore.rentalTypeId }>
                {#each $rentalTypeArrayStore as rentalType }
                    <option value={ rentalType.id }>{ getLocalizedText( rentalType.name, $languageTagStore ) }</option>
                {/each}
            </Select>
        </div>

        <div class="input-row">
            <span class="font-weight-700 line-height-150 color-gray-100">Property type</span>

            <Select fullWidth name="propertyType" bind:value={ $selectedPropertyStore.typeId }>
                {#each $propertyTypeArrayStore as propertyType }
                    <option value={ propertyType.id }>{ getLocalizedText( propertyType.name, $languageTagStore ) }</option>
                {/each}
            </Select>
        </div>

        <div class="input-row">
            <span class="font-weight-700 line-height-150 color-gray-100">Heating type</span>
            <Select fullWidth name="heatingType" bind:value={ $selectedPropertyStore.heatingTypeId }>
                {#each $heatingTypeArrayStore as heatingType }
                    <option value={ heatingType.id }>{ getLocalizedText( heatingType.name, $languageTagStore ) }</option>
                {/each}
            </Select>
        </div>

        <div class="input-row">
            <span class="font-weight-700 line-height-150 color-gray-100">Property status</span>
            <Select fullWidth name="propertyStatus" bind:value={ $selectedPropertyStore.statusId }>
                {#each $propertyStatusArrayStore as propertyStatus }
                    <option value={ propertyStatus.id }>{ getLocalizedText( propertyStatus.name, $languageTagStore ) }</option>
                {/each}
            </Select>
        </div>

        <div class="input-row">
            <span class="font-weight-700 line-height-150 color-gray-100">Diagnosis</span>
            <Select fullWidth name="energyDiagnosisId" bind:value={ $selectedPropertyStore.energyDiagnosisId }>
                {#each $diagnosisArrayStore as diagnosis }
                    <option value={ diagnosis.id }>{ getLocalizedText( diagnosis.name, $languageTagStore ) }</option>
                {/each}
            </Select>
        </div>

        <div class="input-row">
            <span class="font-weight-700 line-height-150 color-gray-100">Date</span>
            <Input
                type="date"
                bind:value={ $selectedPropertyStore.date }
                fullWidth
                name="date"
            />
        </div>

        <div class="input-row space-between inline">
            <span class="font-weight-700 line-height-150 color-gray-100">Apply Short-Term Extended Stay Discount?</span>
            <Switch
                bind:value={ $selectedPropertyStore.hasShortTermExtendedStayDiscount }
                onChange={ handleChange }
            />
        </div>

        <div class="input-row space-between inline">
            <span class="font-weight-700 line-height-150 color-gray-100">Apply Short-Term Prolonged Stay Discount?</span>
            <Switch
                bind:value={ $selectedPropertyStore.hasShortTermProlongedStayDiscount }
                onChange={ handleChange }
            />
        </div>

        <div class="input-row space-between inline">
            <span class="font-weight-700 line-height-150 color-gray-100">Available for Long-Term Stay?</span>
            <Switch
                bind:value={ $selectedPropertyStore.isAvailableForLongTerm }
                onChange={ handleChange }
            />
        </div>

        <div class="input-row space-between inline">
            <span class="font-weight-700 line-height-150 color-gray-100">Available for Short-Term Stay?</span>
            <Switch
                bind:value={ $selectedPropertyStore.isAvailableForShortTerm }
                onChange={ handleChange }
            />
        </div>

        <div class="input-row space-between inline">
            <span class="font-weight-700 line-height-150 color-gray-100">Available for Subletting?</span>
            <Switch
                bind:value={ $selectedPropertyStore.isAvailableForSublet }
                onChange={ handleChange }
            />
        </div>

        <div class="input-row space-between inline">
            <span class="font-weight-700 line-height-150 color-gray-100">Manages Long-Term Documents?</span>
            <Switch
                bind:value={ $selectedPropertyStore.managesLongTermDocuments }
                onChange={ handleChange }
            />
        </div>

        <div class="input-row space-between inline">
            <span class="font-weight-700 line-height-150 color-gray-100">Requires Complete Request for Visits?</span>
            <Switch
                bind:value={ $selectedPropertyStore.requiresCompleteRequestForVisits }
                onChange={ handleChange }
            />
        </div>

        <div class="input-row space-between inline">
            <span class="font-weight-700 line-height-150 color-gray-100">Shows Precise Location?</span>
            <Switch
                bind:value={ $selectedPropertyStore.showsPreciseLocation }
                onChange={ handleChange }
            />
        </div>
    </form>
</AdminPage>
