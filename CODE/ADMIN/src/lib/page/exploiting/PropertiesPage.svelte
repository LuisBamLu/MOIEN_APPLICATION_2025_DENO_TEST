<script>
    // -- IMPORTS

    import { getLocalizedText, getLocalizedTextBySlug } from 'senselogic-gist';
    import { onMount } from 'svelte';
    import { Link } from 'svelte5-router';
    import { languageTagStore } from '$store/languageTagStore';
    import { fetchData } from '$lib/base';

    // -- STATEMENTS

    let propertyArray = $state([]);
    let isLoading = $state(true);

    onMount(
        async () =>
        {
            try
            {
                let response = await fetchData( '/api/page/properties' );
                propertyArray = response.data.propertyArray;
            }
            catch ( error )
            {
                console.error( 'Error :', error );
            }
            finally
            {
                isLoading = false;
            }
        }
        );
</script>

{#if isLoading }
    <div class="hourglass">{ getLocalizedTextBySlug( 'loading-label', $languageTagStore ) }</div>
{:else}
    <div>
        <h1>Properties</h1>
        {#each propertyArray as property }
            <Link to={ '/admin/property/' + property.id }>
                <div class="property">
                    <p>{ getLocalizedText( property.title ) }</p>
                </div>
            </Link>
        {/each}
    </div>
{/if}
