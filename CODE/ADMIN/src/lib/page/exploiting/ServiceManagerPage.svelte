<script>
    // @ts-nocheck

    // -- IMPORTS

    import { getOptionArray } from '$lib/base';
    import
    {
        serviceArrayStore,
        serviceTypeArrayStore,
        isServiceModalOpen,
        toggleServiceModal,
        selectedServiceStore,
        loadServiceArray,
        handleCreateService,
        handleEditService,
        handleDeleteService,
        profileArrayStore
    }
    from '$store/serviceStore';
    import AdminPage from '$component/element/AdminPage.svelte';

    // -- VARIABLES

    let filterParameterByKeyMap =
    {
        id :
        {
            type: 'text',
            name: 'ID',
            value: ''
        },
        name :
        {
            type: 'text',
            name: 'Name',
            value: ''
        },
        isMonthly :
        {
            type: 'boolean',
            name: 'Monthly',
            value: ''
        },
        userId :
        {
            type: 'text',
            name: 'User',
            value: ''
        },
    };
    let titleSlugMap =
    {
        editTitle: 'edit-service-label',
        addTitle: 'add-service-label'
    };
    let config =
        {
            headerArray :
            [
                { type : 'text', label : 'Name', key : 'name' },
                { type : 'boolean', label : 'Monthly', key : 'isMonthly' },
                { type : 'text', label : 'User', key : 'username' },
            ],
            dataArray : $serviceArrayStore.map(
                ( service, serviceIndex ) =>
                {
                    let profile = $profileArrayStore[ serviceIndex ];

                    return (
                        {
                            ...service,
                            username : profile.firstName,
                            profile,
                        }
                        );
                }
                ) || [],
        };

    // -- FUNCTIONS

    function arrayProcessing(
        )
    {
        $serviceArrayStore = $serviceArrayStore.map(
            ( service ) =>
            {
                // let profile = ( $profileArrayStore.find( ( profile ) => profile.userId === Service.userId ) );

                // service.userName = profile ? `${ profile.firstName } ${ profile.lastName }` : 'Unknown';

                return service;
            }
            );
    }
</script>

<AdminPage
    pageTitle="admin-menu-services-manager-label"
    selectedObject={ selectedServiceStore }
    objectArrayStore={ serviceArrayStore }
    isObjectModalOpen={ isServiceModalOpen }
    filterParameterByKeyMap={ filterParameterByKeyMap }
    titleSlugMap={ titleSlugMap }
    loadObjectArray={ loadServiceArray }
    arrayProcessing={ arrayProcessing }
    handleCreateObject={ handleCreateService }
    handleEditObject={ handleEditService }
    handleDeleteObject={ handleDeleteService }
    toggleObjectModal={ toggleServiceModal }
    objectConfigMap={ config }
    showButton={ false }
/>
