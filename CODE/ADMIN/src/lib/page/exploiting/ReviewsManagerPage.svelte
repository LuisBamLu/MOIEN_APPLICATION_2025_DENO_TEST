<script>
    // -- IMPORTS

    import
    {
        handleCreateUserReview,
        handleDeleteUserReview,
        handleEditUserReview,
        isUserReviewModalOpen,
        loadUserReviewArray,
        profileArrayStore as userReviewProfileArrayStore,
        userReviewArrayStore,
        selectedUserReviewStore,
        toggleUserReviewModal,
        hasMorePage as hasMoreUserReviewPage,
        isUserReviewLoading
    }
    from '$store/userReviewStore';
    import
    {
        handleCreateRentalReview,
        handleDeleteRentalReview,
        handleEditRentalReview,
        isRentalReviewModalOpen,
        loadRentalReviewArray,
        profileArrayStore as rentalReviewProfileArrayStore,
        propertyArrayStore,
        rentalReviewArrayStore,
        selectedRentalReviewStore,
        toggleRentalReviewModal,
        hasMorePage as hasMoreRentalReviewPage,
        isRentalReviewLoading
    }
    from '$store/rentalReviewStore';
    import AdminPageTabs from '$component/element/AdminPageTabs.svelte';
    import { hasUserPermission } from '$store/profileStore';

    // -- VARIABLES

    let filterParameterByKeyMap =
    [
        {
            userName:
            {
                type: 'text',
                name: 'User',
                value: ''
            },
            ratedUserName:
            {
                type: 'text',
                name: 'Rated user',
                value: ''
            },
            rating:
            {
                type : 'number',
                name : 'Rating',
                value : 0
            },
            text:
            {
                type: 'text',
                name: 'Text',
                value: ''
            },
            creationTimestamp:
            {
                type: 'date',
                name: 'Created at',
                value: new Date().toISOString()
            },
            updateTimestamp:
            {
                type: 'date',
                name: 'Updated at',
                value: new Date().toISOString()
            }
        },
        {
            userName:
            {
                type: 'text',
                name: 'User',
                value: ''
            },
            propertyTitle:
            {
                type: 'text',
                name: 'Property',
                value: ''
            },
            rating:
            {
                type : 'number',
                name : 'Rating',
                value : 0
            },
            cleanlinessRating:
            {
                type: 'number',
                name: 'Cleanlinesss rating',
                value: 0
            },
            communicationRating:
            {
                type: 'number',
                name: 'Communication rating',
                value: 0
            },
            checkInRating:
            {
                type: 'number',
                name: 'Check-in rating',
                value: 0
            },
            accuracyRating:
            {
                type: 'number',
                name: 'Accuracy rating',
                value: 0
            },
            locationRating:
            {
                type: 'number',
                name: 'Location rating',
                value: 0
            },
            valueRating:
            {
                type: 'number',
                name: 'Value rating',
                value: 0
            },
            text:
            {
                type: 'text',
                name: 'Text',
                value: ''
            },
            creationTimestamp:
            {
                type: 'date',
                name: 'Created at',
                value: new Date().toISOString()
            },
            updateTimestamp:
            {
                type: 'date',
                name: 'Updated at',
                value: new Date().toISOString()
            }
        }
    ]
    const titleSlugMap =
    [
        {
            tabTitle: 'admin-menu-user-review-manager-label',
            editTitle: 'edit-user-review-label',
            addTitle: 'add-user-review-label'
        },
        {
            tabTitle: 'admin-menu-rental-review-manager-label',
            editTitle: 'edit-rental-review-label',
            addTitle: 'add-rental-review-label'
        }
    ];
    let filterableColumnArray =
    [
        {
            id: { columnLabel: 'Rating ID', type: 'text' },
            ratedUserProfileId: { columnLabel: 'Rated user', type: 'profile' },
            rating: { columnLabel: 'Rating', type: 'text' },
            text: { columnLabel: 'Text', type: 'text' },
            userId: { columnLabel: 'User', type: 'profile' },
            creationTimestamp: { columnLabel: 'Created at', type: 'timestamp' },
            updateTimestamp: { columnLabel: 'Updated at', type: 'timestamp' }
        },
        {
            id: { columnLabel: 'Review ID', type: 'text' },
            propertyId: { columnLabel: 'Property', type: 'text' },
            rating: { columnLabel: 'Rating', type: 'text' },
            cleanlinessRating: { columnLabel: 'Cleanliness Rating', type: 'text' },
            communicationRating: { columnLabel: 'Communication Rating', type: 'text' },
            checkInRating: { columnLabel: 'Check-in Rating', type: 'text' },
            accuracyRating: { columnLabel: 'Accuracy Rating', type: 'text' },
            locationRating: { columnLabel: 'Location Rating', type: 'text' },
            valueRating: { columnLabel: 'Value Rating', type: 'text' },
            text: { columnLabel: 'Text', type: 'text' },
            userId: { columnLabel: 'User', type: 'profile' },
            creationTimestamp: { columnLabel: 'Created at', type: 'timestamp' },
            updateTimestamp: { columnLabel: 'Updated at', type: 'timestamp' }
        }
    ];
    let selectedObjectStoreArray =
    [
        selectedUserReviewStore,
        selectedRentalReviewStore
    ];
    let objectArrayStoreArray =
    [
        userReviewArrayStore,
        rentalReviewArrayStore
    ];
    let isObjectModalOpenArray =
    [
        isUserReviewModalOpen,
        isRentalReviewModalOpen
    ];
    let loadObjectArray =
    [
        loadUserReviewArray,
        loadRentalReviewArray
    ];
    let handleCreateObjectArray =
    [
        handleCreateUserReview,
        handleCreateRentalReview
    ];
    let handleEditObjectArray =
    [
        handleEditUserReview,
        handleEditRentalReview
    ];
    let handleDeleteObjectArray =
    [
        handleDeleteUserReview,
        handleDeleteRentalReview
    ];
    let toggleObjectModalArray =
    [
        toggleUserReviewModal,
        toggleRentalReviewModal
    ];
    let handleNearBottomArray =
    [
        function (
            event
            )
        {
            let { page } = event.detail;

            if ( $hasMoreUserReviewPage && !$isUserReviewLoading )
            {
                loadUserReviewArray( page );
            }
        },
        function (
            event
            )
        {
            let { page } = event.detail;

            if ( $hasMoreRentalReviewPage && !$isRentalReviewLoading )
            {
                loadRentalReviewArray( page );
            }
        },
    ];

    // -- FUNCTIONS

    const arrayProcessing =
    [
        function ()
        {
        },
        function ()
        {
        }
    ];
</script>

<AdminPageTabs
    pageTitle="property-rental-review-label"
    selectedObject={ selectedObjectStoreArray }
    objectArrayStore={ objectArrayStoreArray }
    isObjectModalOpen={ isObjectModalOpenArray }
    filterParameterByKeyMap={ filterParameterByKeyMap }
    filterableColumnByColumnNameMapArray={ filterableColumnArray }
    titleSlugMap={ titleSlugMap }
    loadObjectArray={ loadObjectArray }
    arrayProcessingArray={ arrayProcessing }
    handleCreateObjectArray={ handleCreateObjectArray }
    handleEditObjectArray={ handleEditObjectArray }
    handleDeleteObjectArray={ handleDeleteObjectArray }
    toggleObjectModalArray={ toggleObjectModalArray }
    showButton={ hasUserPermission( 'add-review' ) }
    handleNearBottomArray={ handleNearBottomArray }
/>
